# Lambda migration
## Description

Lambda Service has a collection of native libraries to use with Python but in our code we are using 'Pandas Library', which is a library that is not included by default in Lambda. To be able to use this library we need to upload the package of files to the lambda container. 


###### Update AWS Keys
1. Locate the following files in this repository:
	- AmazonKey.py
	- lambda_function.py 
	- upload_to_lambda/
		- ...

```
 -AmazonKeys.py
 -lambda_function.py
 -upload_to_lambda/
  -...
```

2. Inside AmazonKeys.py, replace to yours AWS Account keys and your Webex Teams Bot Token Key.
```
bot_token = "ASD23QWQSH&/8EAS..."
aws_access = "SADGAYJFSKD..."
aws_secret = "ASDASJDNQWUW2738TWDUNJAKWDN2EWQ..."
```
> To generate Webex Teams Bot Token please go back to README.md [Visit Here](https://github.com/MV-Automation/MV_Pandemic_Solution/blob/main/AWS/README.md))


###### Update Bucket
1. Open file *lambda_function.py*
2. Replace line #39 with the name of the new bucket you had created.

``` python
38 print(markdown_message)
39 bot_bucket = 'my_new_bucket_name'
40 
```
3. Finally, replace line #82 with the name of the new bucket you had created.

``` python
38 mergeFile = archivo
82 bucket = 'my_new_bucket_name'
40 
```


###### Modify Webex Team Bot Receipts
1. Open file *lambda_function.py*
2. In line #30, you should add at least one receipt for notifcations. 
	- You could add many mails separte by collon. 

``` python
29 data_list = data_list
30 mails_to_send = ['mail@cisco.com', 'mail2@cisco.com']
31 
```

###### Update SQS URL
1. Open file *lambda_function.py*
2. In line #86, insert the URL generated by Simple Queue Service from AWS.

``` python
84 access_denied = []
86 queue_url = "https://sqs.us-east-2.amazonaws.com/123456789/your_new_queue"
87 
```


###### Uploading Code (ZIP File)

After doing upper steps, please move AmazonKeys.py and lambda_function.py to uploat_to_lamda folder. Then, create a ZIP file with all the folder.

```
upload_to_lambda/
 -AmazonKeys.py
 -lambda_function.py
 -...
```
	
Furthermore, upload the ZIP file generated to previous lambda function created in Amazon Web Service.
